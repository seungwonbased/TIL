# Spring Container

μ¤ν”„λ§ ν”„λ μ„μ›ν¬λ” μ¤ν”„λ§ κΈ°λ° μ• ν”λ¦¬μΌ€μ΄μ…μ μ»΄ν¬λ„νΈλ¥Ό κ΄€λ¦¬ν•λ” μ±…μ„μ΄ μλ” μ»¨ν…μ΄λ„λ¥Ό μ κ³µν•©λ‹λ‹¤. μ΄ μ»¨ν…μ΄λ„λ” **μ¤ν”„λ§ μ»¨ν…μ΄λ„ λλ” IoC μ»¨ν…μ΄λ„**λΌκ³ λ„ ν•©λ‹λ‹¤. IoCλ” Inversion of Controlμ μ•½μμ…λ‹λ‹¤.

**μ¤ν”„λ§ μ»¨ν…μ΄λ„λ” κ°μ²΄λ¥Ό μƒμ„±ν•κ³ , μ„λ΅ μ—°κ²°ν•κ³ , κµ¬μ„±ν•λ©°, μƒμ„±λ¶€ν„° μ†λ©ΈκΉμ§€ μ™„μ „ν• λΌμ΄ν”„μ‚¬μ΄ν΄ κ΄€λ¦¬λ¥Ό λ‹΄λ‹Ή**ν•©λ‹λ‹¤. **μ΄λ¥Ό μ„ν•΄ μ»¨ν…μ΄λ„λ” μμ΅΄μ„± μ£Όμ…μ„ μ‚¬μ©**ν•©λ‹λ‹¤.

μ¤ν”„λ§ μ»¨ν…μ΄λ„μ—λ” λ‘ κ°€μ§€ μ ν•μ΄ μμµλ‹λ‹¤:

![container](https://github.com/seungwonbased/TIL/blob/main/Spring/assets/container1.png)

## 1. BeanFactory

BeanFactoryλ” κ°€μ¥ κ°„λ‹¨ν• μ»¨ν…μ΄λ„λ΅, μμ΅΄μ„± μ£Όμ…, λΌμ΄ν”„μ‚¬μ΄ν΄ κ΄€λ¦¬, μ‹±κΈ€ν†¤ λ° ν”„λ΅ν† νƒ€μ… μ²λ¦¬μ™€ κ°™μ€ κΈ°λ³Έ μ„λΉ„μ¤ λ° κµ¬μ„± λ©”μ»¤λ‹μ¦μ„ μ κ³µν•©λ‹λ‹¤.

- μ¤ν”„λ§ μ»¨ν…μ΄λ„μ μµμƒμ„ μΈν„°νμ΄μ¤
- μ¤ν”„λ§ λΉμ„ κ΄€λ¦¬ν•κ³  μ΅°νν•λ” μ—­ν•  λ‹΄μ¥
- **`getBean()`**μ„ μ κ³µ

## 2. ApplicationContext

![container](https://github.com/seungwonbased/TIL/blob/main/Spring/assets/container2.png)

- BeanFactoryμ λ¨λ“  κΈ°λ¥μ„ μƒμ†λ°›μ•„μ„ μ κ³µ
- BeanFactoryλ³΄λ‹¤ λ” λ‹¤μ–‘ν• λ¶€κ°€κΈ°λ¥ μ κ³µ β†’ μ• ν”λ¦¬μΌ€μ΄μ… κ°λ°μ„ μ„ν•¨
    - λ©”μ„Έμ§€ μ†μ¤λ¥Ό ν™μ©ν• κµ­μ ν™” κΈ°λ¥
        - μλ¥Ό λ“¤μ–΄ ν•κµ­μ—μ„ λ“¤μ–΄μ¤λ©΄ ν•κµ­μ–΄λ΅, μμ–΄κ¶μ—μ„ λ“¤μ–΄μ¤λ©΄ μμ–΄λ΅ μ¶λ ¥
    - ν™κ²½ λ³€μ
        - λ΅μ»¬, κ°λ°, μ΄μ μ„λ²„λ¥Ό κµ¬λ¶„ν•΄μ„ μ²λ¦¬
    - μ• ν”λ¦¬μΌ€μ΄μ… μ΄λ²¤νΈ
        - μ΄λ²¤νΈλ¥Ό λ°ν–‰ν•κ³  κµ¬λ…ν•λ” λ¨λΈμ„ νΈλ¦¬ν•κ² μ§€μ›
    - νΈλ¦¬ν• λ¦¬μ†μ¤ μ΅°ν
        - νμΌ, ν΄λμ¤ν¨μ¤, μ™Έλ¶€ λ“±μ—μ„ λ¦¬μ†μ¤λ¥Ό νΈλ¦¬ν•κ² μ΅°ν

## μ¤ν”„λ§ μ»¨ν…μ΄λ„μ μ£Όμ” κΈ°λ¥

1. **κ²½λ‰ν™”**: μ¤ν”„λ§ μ»¨ν…μ΄λ„λ” κ²½λ‰ν™”λμ–΄ μμΌλ©°, κ°λ°μκ°€ κΈ°λ³Έ ν΄λμ¤λ¥Ό ν™•μ¥ν•κ±°λ‚ μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•λ„λ΅ κ°•μ”ν•μ§€ μ•μµλ‹λ‹¤.
2. **μ μ–΄μ μ—­μ „**: μ¤ν”„λ§ μ»¨ν…μ΄λ„λ” IoCλ¥Ό κµ¬ν„ν•λ―€λ΅ κ°μ²΄ μƒμ„± ν”„λ΅μ„Έμ¤λ¥Ό μ μ–΄ν•κ³  ν•„μ”ν• μμ΅΄μ„±μ„ κ°μ²΄μ— μ£Όμ…ν•©λ‹λ‹¤.
3. **μμ΅΄μ„± μ£Όμ…**: μ¤ν”„λ§ μ»¨ν…μ΄λ„λ” μ¤ν”„λ§ κΈ°λ° μ• ν”λ¦¬μΌ€μ΄μ…μ μ»΄ν¬λ„νΈλ¥Ό κ΄€λ¦¬ν•κΈ° μ„ν•΄ μμ΅΄μ„± μ£Όμ…μ„ μ‚¬μ©ν•©λ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ λ¨λ“ν™” λ° μ μ—°ν• μ½”λ“ μ‘μ„±μ΄ μ©μ΄ν•΄μ§‘λ‹λ‹¤.
4. **λΌμ΄ν”„μ‚¬μ΄ν΄ κ΄€λ¦¬**: μ¤ν”„λ§ μ»¨ν…μ΄λ„λ” μƒμ„±λ¶€ν„° μ†λ©ΈκΉμ§€μ κ°μ²΄μ μ „μ²΄ λΌμ΄ν”„μ‚¬μ΄ν΄μ„ κ΄€λ¦¬ν•©λ‹λ‹¤. μ΄λ΅ μΈν•΄ κ°μ²΄κ°€ μ μ ν•κ² μ΄κΈ°ν™”λκ³  μ†λ©Έλ©λ‹λ‹¤.
5. **κµ¬μ„± κ΄€λ¦¬**: μ¤ν”„λ§ μ»¨ν…μ΄λ„λ” XML, μ£Όμ„ λλ” Java κΈ°λ° κµ¬μ„±μ„ μ‚¬μ©ν•μ—¬ μ• ν”λ¦¬μΌ€μ΄μ…μ„ κµ¬μ„±ν•  μ μλ” μ μ—°ν• κµ¬μ„± λ©”μ»¤λ‹μ¦μ„ μ κ³µν•©λ‹λ‹¤.

κ²°λ΅ μ μΌλ΅, μ¤ν”„λ§ μ»¨ν…μ΄λ„λ” μ¤ν”„λ§ κΈ°λ° μ• ν”λ¦¬μΌ€μ΄μ…μ μ»΄ν¬λ„νΈλ¥Ό κ΄€λ¦¬ν•κΈ° μ„ν• κ°•λ ¥ν•κ³  μ μ—°ν• λ„κµ¬μ…λ‹λ‹¤. μ μ–΄μ μ—­μ „κ³Ό μμ΅΄μ„± μ£Όμ… κµ¬ν„μ„ μ„ν• κ²½λ‰ν™” λ° λΉ„μΉ¨ν¬μ  ν”„λ μ„μ›ν¬λ¥Ό μ κ³µν•©λ‹λ‹¤.

# κΈ°μ΄

- ApplicationContextλ¥Ό μ¤ν”„λ§ μ»¨ν…μ΄λ„λΌκ³  ν•¨ (μΈν„°νμ΄μ¤μ„)
- μ• λ…Έν…μ΄μ… κΈ°λ°μ μλ°” μ„¤μ • ν΄λμ¤λ΅ λ§λ“¤ μ μμ
- μ¤ν”„λ§ μ»¨ν…μ΄λ„λ” **@Configuration**μ΄ λ¶™μ€ ν΄λμ¤λ¥Ό μ„¤μ • μ •λ³΄λ΅ μ‚¬μ©
    - μ—¬κΈ°μ„ @Beanμ΄λΌ μ μΈ λ©”μ„λ“λ¥Ό λ¨λ‘ νΈμ¶ν•μ—¬ λ°ν™λ κ°μ²΄λ¥Ό μ¤ν”„λ§ μ»¨ν…μ΄λ„μ— λ“±λ΅
        - μ΄λ ‡κ² λ“±λ΅λ κ°μ²΄κ°€ Spring bean
        - μ¤ν”„λ§ λΉμ€ **@Bean**μ΄ λ¶™μ€ λ©”μ„λ“ λ…μ„ μ¤ν”„λ§ λΉμ μ΄λ¦„μΌλ΅ μ‚¬μ©
- μ°Έκ³ : [Spring DI, IoC, Bean](DIIoCBean.md)

# Bean λ“±λ΅ κ³Όμ •

1. **`@Component`**λ‚ **`@Service`**, **`@Controller`**, **`@Repository`** λ“±μ μ–΄λ…Έν…μ΄μ…μ„ μ΄μ©ν•μ—¬ Beanμ„ λ“±λ΅ν•  ν΄λμ¤λ¥Ό μ§€μ •ν•©λ‹λ‹¤.
2. λ“±λ΅ν•  ν΄λμ¤μ—μ„ ν•„μ”ν• μμ΅΄μ„±μ„ **`@Autowired`** μ–΄λ…Έν…μ΄μ…μ„ μ΄μ©ν•μ—¬ μλ™μΌλ΅ μ£Όμ…ν•©λ‹λ‹¤. (μμ΅΄μ„± μ£Όμ…μ€ μƒμ„±μ μ£Όμ…, ν•„λ“ μ£Όμ…, λ©”μ„λ“ μ£Όμ… λ°©μ‹ λ“±μ΄ μμµλ‹λ‹¤.)
3. **`@Configuration`** μ–΄λ…Έν…μ΄μ…μ„ μ΄μ©ν•μ—¬ μ„¤μ • ν΄λμ¤λ¥Ό λ§λ“­λ‹λ‹¤.
    1. μ„¤μ • μ •λ³΄λ¥Ό μ°Έκ³ ν•μ—¬ μμ΅΄κ΄€κ³„λ¥Ό μ£Όμ…
4. μ„¤μ • ν΄λμ¤μ—μ„ **`@Bean`** μ–΄λ…Έν…μ΄μ…μ„ μ΄μ©ν•μ—¬ Beanμ„ λ“±λ΅ν•©λ‹λ‹¤. **`@Bean`** μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•λ©΄ λ©”μ„λ“κ°€ λ°ν™ν•λ” κ°μ²΄λ¥Ό BeanμΌλ΅ λ“±λ΅ν•©λ‹λ‹¤.
5. Spring μ»¨ν…μ΄λ„λ” λ“±λ΅λ Beanμ„ κ΄€λ¦¬ν•κ³ , ν•„μ”ν•  λ• ν•΄λ‹Ή Beanμ„ λ°ν™ν•©λ‹λ‹¤.

μλ¥Ό λ“¤μ–΄, λ‹¤μκ³Ό κ°™μ΄ **`@Service`** μ–΄λ…Έν…μ΄μ…μ„ μ΄μ©ν•μ—¬ UserService ν΄λμ¤λ¥Ό BeanμΌλ΅ λ“±λ΅ν•  μ μμµλ‹λ‹¤.

```java
@Service
public class UserService {
  @Autowired
  private UserRepository userRepository;

  // ...
}
```

μ„ μ½”λ“μ—μ„ **`UserService`** ν΄λμ¤λ” **`@Service`** μ–΄λ…Έν…μ΄μ…μ„ μ΄μ©ν•μ—¬ BeanμΌλ΅ λ“±λ΅λλ©°, ν•„μ”ν• **`UserRepository`** ν΄λμ¤λ” **`@Autowired`** μ–΄λ…Έν…μ΄μ…μ„ μ΄μ©ν•μ—¬ μλ™μΌλ΅ μ£Όμ…λ©λ‹λ‹¤.

λν•, λ‹¤μκ³Ό κ°™μ΄ **`@Configuration`** μ–΄λ…Έν…μ΄μ…μ„ μ΄μ©ν•μ—¬ AppConfig ν΄λμ¤λ¥Ό λ§λ“¤μ–΄ Beanμ„ λ“±λ΅ν•  μ μμµλ‹λ‹¤.

```java
@Configuration
public class AppConfig {
  @Bean
  public UserService userService() {
    return new UserService();
  }

  @Bean
  public UserRepository userRepository() {
    return new UserRepository();
  }

  // ...
}
```

μ„ μ½”λ“μ—μ„ **`AppConfig`** ν΄λμ¤λ” **`@Configuration`** μ–΄λ…Έν…μ΄μ…μ„ μ΄μ©ν•μ—¬ μ„¤μ • ν΄λμ¤λ΅ μ§€μ •λλ©°, **`@Bean`** μ–΄λ…Έν…μ΄μ…μ„ μ΄μ©ν•μ—¬ **`UserService`**μ™€ **`UserRepository`** ν΄λμ¤λ¥Ό BeanμΌλ΅ λ“±λ΅ν•©λ‹λ‹¤. μ΄ν›„ Spring μ»¨ν…μ΄λ„λ” λ“±λ΅λ Beanμ„ κ΄€λ¦¬ν•κ³ , ν•„μ”ν•  λ• ν•΄λ‹Ή Beanμ„ λ°ν™ν•©λ‹λ‹¤.

<aside>
π¨ λΉ μ΄λ¦„μ€ ν•­μƒ λ‹¤λ¥Έ μ΄λ¦„μ„ λ¶€μ—¬ν•΄μ•Ό ν•¨, κ°™μ€ μ΄λ¦„μ„ λ¶€μ—¬ν•λ©΄ λ‹¤λ¥Έ λΉμ΄ λ¬΄μ‹λκ±°λ‚ λ®μ–΄λ²„λ¦΄ μ μμ

</aside>

# Bean μ΅°ν

Springμ—μ„ Beanμ„ μ΅°νν•λ” λ°©λ²•μ€ ν¬κ² λ‘ κ°€μ§€κ°€ μμµλ‹λ‹¤.

1. **`@Autowired`** μ–΄λ…Έν…μ΄μ…μ„ μ΄μ©ν• μλ™ μ£Όμ… λ°©λ²•
    - Spring μ»¨ν…μ΄λ„μ—μ„ ν•΄λ‹Ή νƒ€μ…μ Beanμ„ μ°Ύμ•„ μλ™μΌλ΅ μ£Όμ…ν•©λ‹λ‹¤.
    - **`@Autowired`** μ–΄λ…Έν…μ΄μ…μ„ ν•„λ“, μƒμ„±μ, λ©”μ„λ“μ— μ μ©ν•  μ μμµλ‹λ‹¤.
    
    ```java
    @Autowired
    private UserService userService;
    
    // λλ”
    
    private final UserService userService;
    
    public SomeService(UserService userService) {
      this.userService = userService;
    }
    
    // λλ”
    
    @Autowired
    public void setUserService(UserService userService) {
      this.userService = userService;
    }
    ```
    
2. Spring μ»¨ν…μ΄λ„μ—μ„ μ§μ ‘ Beanμ„ μ΅°νν•λ” λ°©λ²•
    - **`ApplicationContext`** μΈν„°νμ΄μ¤λ¥Ό μ΄μ©ν•μ—¬ Beanμ„ μ§μ ‘ μ΅°νν•  μ μμµλ‹λ‹¤.
    - **`getBean()`** λ©”μ„λ“λ¥Ό μ΄μ©ν•μ—¬ Beanμ μ΄λ¦„ λλ” νƒ€μ…μ„ μ§€μ •ν•μ—¬ μ΅°νν•  μ μμµλ‹λ‹¤.
    
    ```java
    // Beanμ μ΄λ¦„μΌλ΅ μ΅°ν
    UserService userService = applicationContext.getBean("userService", UserService.class);
    
    // Beanμ νƒ€μ…μΌλ΅ μ΅°ν
    UserService userService = applicationContext.getBean(UserService.class);
    ```
    
    μ΄ λ•, Bean μ΄λ¦„μ€ ν΄λμ¤ μ΄λ¦„μ μ²« κΈ€μλ¥Ό μ†λ¬Έμλ΅ λ³€ν™ν• μ΄λ¦„μ…λ‹λ‹¤. μλ¥Ό λ“¤μ–΄, **`UserService`** ν΄λμ¤λ” **`userService`**λΌλ” μ΄λ¦„μΌλ΅ λ“±λ΅λ©λ‹λ‹¤. μ΄λ¦„μ„ μ§€μ •ν•μ§€ μ•μ€ κ²½μ°μ—λ” νƒ€μ…μΌλ΅ Beanμ„ μ΅°νν•©λ‹λ‹¤.
    

μ„ λ‘ κ°€μ§€ λ°©λ²• μ¤‘ μ μ ν• λ°©λ²•μ„ μ„ νƒν•μ—¬ Beanμ„ μ΅°νν•  μ μμµλ‹λ‹¤.

## μ΅°ν - μƒμ† κ΄€κ³„

- λ¶€λ¨ νƒ€μ…μΌλ΅ μ΅°νν•λ©΄, μμ‹ νƒ€μ…λ„ ν•¨κ» μ΅°νλ¨
    - κ·Έλμ„ `**Object**` νƒ€μ…μΌλ΅ μ΅°νν•λ©΄ λ¨λ“  μ¤ν”„λ§ λΉμ„ μ΅°ν

# λ‹¤μ–‘ν• μ„¤μ • ν•μ‹ μ§€μ›

![container](https://github.com/seungwonbased/TIL/blob/main/Spring/assets/container3.png)

## μ• λ…Έν…μ΄μ… κΈ°λ° μλ°” μ½”λ“ μ„¤μ • μ‚¬μ©

- **`AnnotationConfigApplicationContext(AppConfig.class)`**
- **`AnnotationConfigApplicationContext`** ν΄λμ¤λ¥Ό μ‚¬μ©ν•λ©° μλ°” μ½”λ“λ΅ λ μ„¤μ • μ •λ³΄λ¥Ό λ„κΈ°λ©΄ λ¨

## XML κΈ°λ° μ„¤μ • μ‚¬μ©

# μ¤ν”„λ§ λΉ μ„¤μ • λ©”νƒ€ μ •λ³΄ - BeanDefinition

μ¤ν”„λ§μ΄ λ‹¤μ–‘ν• μ„¤μ • ν•μ‹μ„ μ§€μ›ν•  μ μλ” μ΄μ λ” BeanDefinition λ•λ¬Έμ΄λ‹¤.

μ‰½κ² μ΄μ•ΌκΈ°ν•΄μ„ β€μ—­ν• κ³Ό κµ¬ν„μ„ κ°λ…μ μΌλ΅ λ‚λ κ²ƒβ€™

**μ¤ν”„λ§μ΄ λ‹¤μ–‘ν• ν•νƒμ μ„¤μ • μ •λ³΄λ¥Ό BeanDefinitionμΌλ΅ μ¶”μƒν™”ν•΄μ„ μ‚¬μ©ν•λ‹¤λ” κ²ƒλ§ μ•μ•„λ‘λ©΄ λ¨**

- XMLμ„ μ½μ–΄μ„ BeanDefinitionμ„ λ§λ“¬
- μλ°” μ½”λ“λ¥Ό μ½μ–΄μ„ BeanDefinitionμ„ λ§λ“¬
- μ¤ν”„λ§ μ»¨ν…μ΄λ„λ” μλ°” μ½”λ“μΈμ§€, XMLμΈμ§€ λ°λΌλ„ μ¤μ§ BeanDefinitionλ§ λ§λ“¤λ©΄ λλ‹¤

## BeanDefinition

- λΉ μ„¤μ • λ©”νƒ€ μ •λ³΄
- **`@Bean`**, **`<bean>`** λ‹Ή κ°κ° ν•λ‚μ”© λ©”νƒ€ μ •λ³΄κ°€ μƒμ„±
- μ¤ν”„λ§ μ»¨ν…μ΄λ„λ” μ΄ λ©”νƒ€ μ •λ³΄λ¥Ό κΈ°λ°μΌλ΅ μ¤ν”„λ§ λΉμ„ μƒμ„±
- μ¤ν”„λ§ μ»¨ν…μ΄λ„λ” BeanDefinitionμ—λ§ μμ΅΄
- μ •λ³΄κ°€ λ¬΄μ¨ μΆ…λ¥κ°€ μλ”μ§€ λ³΄λ ¤λ©΄ κµ¬κΈ€λ§
- μ‹¤λ¬΄μ—μ„ μ‚¬μ©ν•  μΌμ€ κ±°μ μ—†μ
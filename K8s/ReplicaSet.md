# ReplicaSet

- 일정 개수의 Pod를 유지하는 컨트롤러
- 정해진 수의 동일한 Pod가 항상 실행되도록 관리
- 노드에 골고루 Pod를 생성
- 노드 장애 등의 이유로 Pod를 사용할 수 없다면 다른 노드에 Pod를 다시 생성
- 예시
	- 동일한 컨테이너 여러개를 실행하는 경우
	- 동일한 파드를 여러개 정의해서 실행
		- 매우 비효율적인 작업
			- 파드가 삭제되거나, 파드가 위치한 노드에 장애가 발생해서 파드에 접근하지 못하는 경우, 관리자가 직접 파드를 삭제하고 다시 생성해야 하기 때문
- ReplicaSet을 정의하는 메니페스트 파일을 작성
- RS를 삭제하면 RS에 의해 생성된 Pod가 모두 삭제됨
- RS의 메니페스트 파일의 레플리카 수를 수정하고 다시 실행시키면 그 숫자에 맞는 비율로 Pod를 조정

## 작동 방식

- 레플리카셋을 정의하는 필드
	- 획득 가능한 파드를 식별하는 방법이 명시된 셀렉터
	- 유지해야 하는 파드 개수를 명시하는 레플리카의 개수
	- 레플리카 수 유지를 위해 생성하는 신규 파드에 대한 데이터를 명시하는 파드 템플릿
- 레플리카셋은 필드에 지정된 설정을 충족하기 위해 필요한 만큼 파드를 만들고 삭제
- 레플리카셋이 새로운 파드를 생성해야 할 경우, 명시된 파드 템플릿을 사용

## 템플릿을 사용하지 않는 파드의 획득

- 단독(bare) 파드를 생성하는 것에는 문제가 없지만, 단독 파드가 레플리카셋의 셀렉터와 일치하는 레이블을 가지지 않도록 하는 것을 강력하게 권장
	- 그 이유는 레플리카셋이 소유하는 파드가 템플릿에 명시된 파드에만 국한되지 않고, 이전 섹션에서 명시된 방식에 의해서도 다른 파드의 획득이 가능하기 때문
- Bare pod가 RS의 셀렉터와 일치하는 레이블을 가지면 Bare pod이 RS에 속하게 됨
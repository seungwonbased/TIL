# 보안의 요소

- **기밀성**: 서로 주고받은 실제 정보에 대한 비밀성을 보장하는 개념
- **무결성**: 서로 주고받은 실제 정보에 대한 정확성을 보장하는 개념
- **가용성** : **정당한** 사용자가 필요할 때마다 즉각적으로 정보에 접근해 사용하는 개념
- 인증 : 송신자와 수신자 사이의 확신을 보장하는 개념
- 부인 봉쇄 : 수신자가 정보를 받았는데 송신자가 이를 부인하는 일 등을 방지하는 개념

# Scanning

## Scanning이란

- 서비스를 제공하는 서버의 작동 여부와 제공하고 있는 서비스를 확인하는 것
- 네트워크의 Request / Response 특성을 이용해 포트가 열려있는 지 여부를 확인한 후, 해당 포트의 취약점을 이용해 공격
- 네트워크 상에서 단말기의 여러 정보를 얻을 수 있음
	- 열려있는 포트, 제공하는 서비스, 동작 중인 데몬 버전, 운영체제 버전, 취약점 등

## Scanning의 종류
### ARP Scan

- ARP 프로토콜을 이용해 네트워크 대역의 정보를 확인
- 예시
	1. 같은 네트워크 대역에서 ARP Request를 보냄
	2. 살아있는 Host는 ARP Reply로 응답
	3. 공격자는 희생자의 존재 유무를 알 수 있게 됨
- ICMP(ping과 같은 것)는 보안 문제상 막을 수 있지만, ARP는 막아버리면 통신이 안되기 때문에 막아 놓을 수 없음
- 그러나 ARP 프로토콜은 라우터를 넘지 않기 때문에 (L2 프로토콜이기 때문에) 같은 네트워크 안의 정보만 알 수 있음

### ICMP Scan

- ICMP 프로토콜(ping)을 이용해 스캔, 희생자 서버의 작동 여부를 알 수 있음
- 타겟까지 도달할 수 있는지 여부와 운영체제 등을 알 수 있음
	- 패킷의 크기, TTL 등으로 판별
- ICMP 프로토콜을 지원하지 않는 기기이거나 보안의 이유로 라우터나 방화벽 등에서 ICMP 사용을 차단하는 경우에는 다른 방법을 사용해야 함
- 시스템 하나를 조사하기엔 적합, 큰 네트워크를 조사하기엔 효과적이지 않음
	- 이런 경우 Sweeping
- Sweeping: 네트워크 전체에서 활성화 시스템을 찾는 일
	- 네트워크에 브로드캐스트를 이용하는 ARP 스캔이나 자동화 도구를 이용해 특정 범위의 네트워크에 ping

### TCP Full Open Scan

- 3-Way Handshaking을 이용해 포트 스캐닝
- 취약점 점검에도 이용되고 해킹에도 이용될 수 있음
- 대표적인 도구는 nmap
- 장점: 결과가 다른 스캔 방식에 비해 정확
- 단점: 보안 장치에 감지 당하기 쉽고 타겟에 로그를 남기게 됨

#### 포트가 열려 있다면
- 정상적인 통신 과정과 동일
- 다른 점은 3-Way Handshaking이 끝난 후에 RST + ACK를 다시 타겟으로 전송
	- 연결을 강제 종료하는 것
	- 포트가 열린 것을 알았으니 더 이상 연결을 유지할 필요가 없기 때문

#### 포트가 닫혀 있다면
- SYN를 보내면 타겟이 RST + ACK를 반환
- 보안 프로그램 동작이나 방화벽에서 차단을 당하는 등의 상황

### Stealth Scan

- 세션을 완전히 성립하지 않고 공격 대상 시스템의 포트 활성화 여부를 알아내기 때문에 타겟 시스템에 로그가 남지 않음

#### TCP Half Open Scan (TCP SYN Open Scan)
- 포트가 열려 있다면
	- 스캔의 시작은 Full Open Scan과 같지만 SYN + ACK 패킷을 받으면 서버의 활성 여부를 알았기 때문에 RST 패킷을 보내 세션을 끊음
- 포트가 닫혀 있다면
	- Full Open Scan과 같음

#### TCP FIN Scan
- TCP의 Flag를 FIN으로 설정해 타겟에 전달하는 방식으로 포트 스캐닝
- 포트가 열려 있다면
	- 타겟에 FIN을 보냄
	- 응답 없음
- 포트가 닫혀 있다면
	- 타겟에 FIN을 보냄
	- 응답으로 RST + ACK이 반환됨
- 포트가 닫혔을 때만 RST + ACK가 오기 때문에 닫힌 포트는 확실히 확인 가능
	- 응답이 없는 경우는 방화벽에 필터링된 것일 수도 있어 확신은 불가능

#### TCP Xmas Scan
- 크리스마스 선물처럼 여러 가지 Flag를 한 번에 타겟으로 보내는 방식으로 포트 스캐닝
- 타겟에 URG, PSH, FIN을 동시에 설정해 보냄
	- 이는 연결을 끊을 때 보내는 Flag인데, 타겟은 이 Flag를 받기 전에 어떠한 연결 Flag를 받은 적이 없으므로 활성화 되어 있다면 응답이 없을 것임
- 포트가 열려 있다면
	- 타겟에 URG, PSH, FIN을 동시에 설정해 보냄
	- 응답 없음
- 포트가 닫혀 있다면
	- 타겟에 URG, PSH, FIN을 동시에 설정해 보냄
	- 응답으로 RST + ACK이 반환됨
- 포트가 닫혔을 때만 RST + ACK가 오기 때문에 닫힌 포트는 확실히 확인 가능
	- 응답이 없는 경우는 방화벽에 필터링된 것일 수도 있어 확신은 불가능

#### TCP Null Scan
- Flag에 아무 것도 설정하지 않은 채로 타겟에 전송하는 방식으로 포트 스캐닝
- 포트가 열려 있다면
	- Flag에 아무 설정도 하지 않고 타겟에 전송
	- 응답 없음
- 포트가 닫혀 있다면
	- Flag에 아무 설정도 하지 않고 타겟에 전송
	- 응답으로 RST + ACK이 반환됨
- 포트가 닫혔을 때만 RST + ACK가 오기 때문에 닫힌 포트는 확실히 확인 가능
	- 응답이 없는 경우는 방화벽에 필터링된 것일 수도 있어 확신은 불가능

# Sniffing

- 패킷 분석 툴(e.g., Wireshark)을 이용해 패킷 내용을 확인하고 분석하는 기법

## Sniffing 원리

- 네트워크에 접속하는 모든 시스템은 IP 주소와 MAC 주소를 가짐
- 이더넷은 로컬 네트워크 내 모든 호스트가 같은 선(Wire)를 공유하도록 되어 있음
- 따라서 같은 네트워크 내의 모든 컴퓨터는 다른 컴퓨터가 통신하는 모든 트래픽을 볼 수 있음
- 하지만 자신을 지나는 모든 트래픽을 받아들이면 네트워크 성능이 저하되므로 자신의 주소를 갖지 않는 트래픽을 무시하는 필터링 기능이 있음
- 이 필터링을 해제해 자신이 가지지 말아야 하는 정보를 받아들여 스니핑을 할 수 있음

> Sniffing이 가능한 이유: TCP/IP 방식에는 암호화가 없어 데이터가 평문으로 전송되므로 제삼자가 패킷 분석 툴을 이용해 페이로드 내용을 볼 수 있음

> 대응 방법: Virtual Private Network
<!--
## Sniffing 종류
### Switch Jamming Attack
### SPAN Port Mirroring
### ARP Redirect
### ICMP Redirect
## Sniffer 탐지 방법
-->

# Spoofing

- 스니핑 등 보안 공격을 위해 자신을 다른 주체(권한 있는 주체 또는 공격 대상 주체)로 속이는 기법

## IP Spoofing

- IP 스푸핑은 특정 시스템이 다른 시스템의 IP를 모방하거나 속여 특정 대상을 공격하는 하나의 네트워크 공격 기법 중 하나
- 주로 DDoS 공격과 같은 네트워크 공격을 위해 흔히 사용되는 기법 중 하나
- IP 패킷을 구성하는 헤더에 사용자 정보를 조작해 IP 주인이 아닌 악의적인 목적을 가진 사용자가 사용하는 것

### IP Spoofing 원리

- 수신자와 발신자 컴퓨터 사이에 신뢰 관계가 맺어져 있어야 함
- 신뢰 관계가 맺어지면 둘 사이에는 어떤 인증도 없이 접속이 가능하게 됨
- 관계가 맺어진 둘의 IP 주소를 가로채 IP로 위장하여 신뢰 관계에 접속

### IP Spoofing의 공격 형태
#### DDoS 공격
- 타겟 시스템과 서버 혹은 타겟과 타겟의 시스템 세션을 강제로 종료시키거나 원활하지 않은 네트워크의 흐름을 유발시키고 접속 장애와 같은 문제를 발생시킬 수 있음

#### 서버 우회 및 방화벽 우회
- 방화벽이나 차단된 서버의 접속을 위해 차단된 IP를 사용하지 않고 IP 스푸핑을 통해 획득한 타인의 IP를 이용해 차단된 서버나 방화벽에서 제어되는 규칙을 우회하여 정상적인 접근으로 위장

#### 개인 정보 유출
- 보안에 취약한 공개 네트워크에서 스니핑과 IP 스푸핑을 통해 네트워크 사용자에 대한 개인정보 및 기기에 접근하거나 메시지, 이메일 등 네트워크 상에서 주고 받는 개인정보 내용을 가로챌 수 있음
## DNS Spoofing

- 인터넷 사용자를 가짜 또는 악의적인 사기 웹 사이트로 리디렉션하는 데 사용됨

### DNS Spoofing 원리

#### 침입
- 가장 확실하지만 어려운 방법
- 타겟으로 지정할 DNS 서버에 액세스할 수 있는 사용자로부터 자격 증명을 받아야 함
- 다양한 피싱 기술, 악성 키로깅 프로그램 등을 사용해야 함
- 자격 증명을 얻었다면 로그인해 DNS 서버의 레코드를 변경할 수 있음

#### DNS Cache Poisoning
- 침입보다는 쉽지만 결과가 오래가지 않음
- 타겟 DNS 서버에 IP 주소를 묻는 쿼리를 보냄
- 타겟 DNS 서버는 네임 서버에 쿼리를 전송하고 공격자는 권한이 있는 DNS 네임 서버인 척 네임 서버에 응답
- 이를 통해 DNS 서버의 캐시에 가짜 IP 주소를 심을 수 있음
- 이 가짜 DNS 항목은 도메인의 사용 빈도에 따라 계속해서 확산될 수 있음
- 중간자 공격의 일종

## ARP Spoofing

- 로컬 네트워크 영역에서 ARP를 이용해 상대방의 데이터 패킷을 중간에서 가로채는 기법
	- 자신의 MAC 주소를 다른 컴퓨터의 MAC인 것처럼 속이는 것

### ARP Cache Poisoning
- 데이터 링크 계층에서 목적지 맥 주소를 조작하는 방식
- ARP 캐시 테이블에서 사용하는 주소 체계를 조작

# Flooding

- 출발지 IP 주소를 수시로 변경하면서 상대방에세 불필요한 데이터를 계속 전송해 인위적인 과부하를 유발시키는 기법
- 일반적으로 IP 스푸핑 기법과 결합하여 사용
- DDoS 공격이라고도 부름
- 네트워크 공격 중 가장 위력적인 공격
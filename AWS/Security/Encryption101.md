# Encryption
## Encryption in Flight (SSL)

![enc](https://github.com/seungwonbased/TIL/blob/main/AWS/assets/enc1.png)

- 전송 중 암호화
- 매우 민감한 기밀 내용인 경우 전송 중 암호화를 사용
- 가령 신용카드로 온라인 결제를 하려고 할 때 네트워크 패킷이 가는 길에 다른 사람한테 신용카드 번호가 보여서는 안됨
- 온라인으로 결제할 때 초록색 자물쇠 그림이 있고 SSL이 활성화된 웹사이트임을 보장해주는 HTTPS 웹사이트라면 전송 중 암호화가 된 것
- 전송 중 암호화가 되면 데이터가 전송되기 전 암호화되고 서버가 데이터를 받으면 복호화
	- 하지만 전송하는 이와 서버만이 암호화와 복호화를 하는 방법을 알고 있음
- SSL 인증서가 암호화를 해주고 다른 방법은 HTTPS가 있음
	- 그래서 Amazon 서비스를 다룰 때마다 HTTPS 엔드포인트가 있어서 전송 중 암호화가 됐음을 보장
- 이제 전체 웹, 거의 전체 웹이 SSL과 HTTPS에서 실행되어야 함
	- 기본적으로 이것을 활성화하면 '중간자' 공격으로부터 보호됨
	- 따라서 초록색 자물쇠가 있고 서버 인증서가 유효하면 아무도 민감한 정보를 검색할 수 없음
- 간단한 예시
	- 유저가 있고 DynamoDB 같은 AWS의 HTTP 웹 사이트와 통신하려고 함
	- 그런 다음 비밀 데이터를 추가하고 SSL 암호화로 암호화한 다음 네트워크를 통해 보내면 웹사이트에서 데이터를 수신
	- 웹사이트는 복호화하는 방법을 알고 있음
	- 매우 간단한 개념이지만 실행하기는 쉽지 않음
		- 희소식은 모든 프로그래밍 언어가 SSL 암호화와 복호화를 할 수 있고 모든 라이브러리가 이 작업을 해줘서 여러분은 이 부분은 걱정할 필요가 없음
		- 직접 처리할 필요가 없음

## Server Side Encryption at Rest

![enc](https://github.com/seungwonbased/TIL/blob/main/AWS/assets/enc2.png)

- 서버 측 저장 데이터 암호화
- 데이터가 서버에 수신된 후 암호화하는 것
- 그래서 그 전에는 서버가 데이터를 받아서 복호화를 하고 암호 복호화된 형식에 사용
- 여기서는 서버는 데이터를 디스크에 저장
	- 여기서 알아 둬야 할 점은 서버가 데이터를 암호화된 형태로 저장하고 있다는 것
	- 혹시라도 서버가 해킹을 당하면 데이터가 복호화 되어서는 안되기 때문
- 그러고 나서 데이터는 클라이언트로 다시 전송되기 전에 복호화
- 즉, 데이터 키라고 불리는 키 덕분에 데이터는 암호화된 형태로 저장되고 암호 키와 해독 키는 주로 KMS, Key Management Service 같은 곳에 따로 관리됨
	- 서버는 Key Management Service와 통신할 수 있어야 함
- 예시
	- 객체가 있고 이 객체를 예를 들어 EBS로 전송한다고 가정
	- 이 객체는 어떤 메커니즘으로든 전송되고 EBS는 데이터 키를 써서 그 데이터의 암호화를 수행, 암호화된 형태로 저장
	- 그러면 해당 데이터를 어떤 이유에서든 검색하려고 할 때 EBS 같은 AWS가 우리 대신 데이터 키를 통해 복호화를 하면 복호화된 데이터가 가령 HTTP, HTTPS를 거쳐 돌아오게 됨
	- 서버 측 암호화는 이렇게 진행됨
- 서비스의 서버 자체가 암호화와 복호화를 관리하고 데이터 키를 통해 접근

## Client Side Encryption

![enc](https://github.com/seungwonbased/TIL/blob/main/AWS/assets/enc3.png)

- 클라이언트 측 암호화
- 클라이언트 측 암호화에서 데이터는 클라이언트가 암호화하고, 서버는 그 데이터를 절대 복호화할 수 없음
	- 데이터를 받는 클라이언트에 의해 복호화됨
- 전체적으로 데이터는 서버에 저장되지만 서버는 데이터의 내용을 알 수 없음
	- 서버는 최선의 방법으로도 데이터를 복호화할 수 없어야 함
- 이를 위해 봉투 암호화를 활용할 수 있지만 주제가 꽤 심화된 주제
	- 시험에서 봉투 암호화에 대한 문제가 출제되긴 하지만 지금은 대략적으로만 설명
- 예시
	- 여기 객체가 있고 클라이언트는 데이터 키를 사용해서 클라이언트 측의 데이터를 암호화
	- 그 데이터 키로 암호화를 수행
	- 이제 해당 데이터를 원하는 데이터 저장소로 보냄
		- FTP가 될 수도 있고 S3도 될 수 있고 무엇이든 상관 없음
	- Amazon이나 원하는 다른 곳에 데이터를 저장
	- 그리고 데이터를 받으면 클라이언트는 암호화된 객체를 받고 데이터 키에 액세스가 있거나 다른 곳으로부터 데이터 키를 찾을 수 있으면 받은 데이터를 복호화하여 복호화된 객체를 얻음
	- 암호화는 클라이언트 측에서 수행됨
		- 서버 데이터 저장소는 데이터를 암호화하거나 복호화할 수 없고 그저 암호화된 데이터를 받기만 할 수 있음
